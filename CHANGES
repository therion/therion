Therion 6.1.1 (in progress):

therion:
 * support custom font size in map labels using <size:N%> in the label text

--------------------------------------------------------------------------------

Therion 6.1.0 (2022-05-27):

therion:
 * CHANGED the default settings for 'proj-auto' (on) and 'proj-missing-grid'
   (download) to allow Proj choosing the best transformation and automatically
   download any missing transformation grids
 * added a new ini file option ‘cs-trans’ for user-defined PROJ transformation
   pipelines between two coordinate systems
 * added support for automatic downloading of PROJ transformation grids used
   in cs-trans pipelines from cdn.proj.org
 * layout: color map-fg scrap now uses more different colors to avoid that
   connected scraps are colored the same. Needed in labyrinth-like caves. [#416]
 * support custom font size in map labels using <size:N> in the label text
 * support atlas page labeling A, B, …, Z, AA, AB, … instead of only A, B, …, Z
 * updated bundled libraries: survex/img 1.4.3, Catch2 2.13.9, fmt 8.1.1
 * documentation fixes [#410,#415,#417]
 * updated github workflows [#411]

--------------------------------------------------------------------------------

Therion 6.0.6 (2022-03-12):

therion:
 * added support for hex rgb color specification (e.g. color map-fg ffeeaa)
 * using -value with point extra triggers deprecation warning. It is
   undocumented feature/bug.
 * thbook improvements [#403,404,406,407] (thanks to Rodrigo Severo)
 * support Proj 9.0.0 in test_proj.py

xtherion:
 * bugs fixed:
   - control panel sizing on certain OS and hidpi displays

loch:
 * bugs fixed:
   - mac retina display size fix

infrastructure:
 * cmake: fix a missing icon in therion.exe [#405] (thanks to Matěj Plch)
 * split too long lines in .github/workflows/*.yml
 * support for signed releases: sign the tag + upload a detached signature
   for .tar.gz sources to a Github release (the release is now created by
   the local script make_release.py instead of Github Actions;
   this allows for integration of the rel_notes.py script into make_release.py)

--------------------------------------------------------------------------------

Therion 6.0.5 (2022-02-20):

therion:
 * added support for backtape/backlength readings
 * warning if forwards and backwards readings do not match
   (the difference threshold changed from 2 SD to 3 SD)
 * some missing point and line types added to thbook [#401,402]
 * Catch2 library updated to 2.3.18
 * bugs fixed:
   - lox file generation segfault (solved by poly2tri library update)
   - segfault caused by mixing local and global coordinate system
   - unable to determine direction on zero-length path in scrap [#395]

xtherion:
 * added line section -direction to context menu
 * bugs fixed:
   - fixed a wrong translation
   - wrong handling of filename open as argument
   - SVG import fixed

loch:
 * added PLY walls export (File → Export)
 * added support for cave volume calculation (Tools → Survey statistics)

windows installer:
 * updated 3rd party programs:
   - Tcl/Tk 8.6.12, tkImg 1.4.13, BWidget 1.9.15
   - ImageMagick 7.1.0-24
   - W32TeX 2021/06/24
   - InnoSetup 6.2.0
 * support for multiple languages during the installation
 * two variants available now:
   - built on Windows using MSYS2 environment; contains up-to-date libraries;
     dynamically linked (a lot of DLLs are included)
     [this is now the default for releases]
   - built on Linux using MXE cross-compiler; some of the libraries are
     quite outdated; statically linked; smaller instaler size
     [the only option used between 5.4.0 and 6.0.4 to build the installer]

cmake:
 * support for collecting the required DLLs for deployment [#397]
   (thanks to Matěj Plch)

--------------------------------------------------------------------------------

Therion 6.0.4 (2021-11-28):

therion:
 * MapBackground colour variable available in MetaPost
   (corresponding to 'color map-bg' set in the layout)
 * bugs fixed:
   - fixed bug with counter and depth instrument calibration
   - fixed error message for map containing only previews
   - depth is incorrectly taken from surface legs [#165]
   - cmyk/grayscale color export fix
   - fix shapefile generation issues under Windows (only when using
     the embedded shp library)

loch:
 * bugs fixed:
   - fixed grayscale surface image rendering

xtherion:
 * bugs fixed:
   - sketch import file browser case-sensitive to filename extensions [#390]
   - fix lintian warnings by using a different shebang line

infrastructure:
 * cmake: generate help and locale files for target loch
 * cmake improvements by Matěj Plch [#391]
 * updated Makefile and getvtkver.tcl for loch
 * fix thbook reproducible build (cmake only; SOURCE_DATE_EPOCH should be set)
 * support thbook compilation with luatex
 * use only current OS versions for make-based builds on GHA
 * fix/workaround for wine32 installation on Ubuntu 20.04 on GHA
 * updated libfmt [#388]
 * updated proj testing script

--------------------------------------------------------------------------------

Therion 6.0.3 (2021-10-03):

therion:
 * add support for splay shots in .3d import
 * survex code updated to 1.2.45
 * a new patch to get reproducible .3d files applied
 * bugs fixed:
   - fixed typos in an error message
   - sample files modified not to start with #! characters which confused lintian
   - color map-fg depth: fix the colouring issues and the related metapost error

loch:
 * use help files in .htb format on all platforms
 * fixed cross-platform differences of generated .lox files

xtherion:
 * fixed bug with PocketTopo XVI rendering introduced in 6.0.2

infrastructure:
 * cmake: added compilation of .mo translation file
 * cmake: improved installation using components
 * cmake: reproducibility fixes
 * cmake: added support for generation of the documentation in HTML format

--------------------------------------------------------------------------------

Therion 6.0.2 (2021-09-13):

therion:
 * add compatibility macros for pre-6.0.0 transparency style in MetaPost
 * allow scaling of some point symbols (anchor, bridge, camp, dig, fixedladder,
   noequipment, rope, ropeladder, steps, traverse, viaferrata) [PR#382,384]
 * include Proj 8.1.1 to the Proj testing suite
 * bugs fixed:
   - wrong vertical alignment of legend entries using <br> to split lines
   - \baselineskip not applied to \the\cavename in the map legend
   - fixed the collision of \the\cavename with the north arrow

loch:
 * fix a missing include when compiling with vtk 9.0.1 and gcc 11
   [Debian #984363]

xtherion:
 * improved control over vertical positioning of backgroud images

infrastructure:
 * fix possible mixing of make and cmake generated files [PR#381]
 * fix static linking issues under recent MinGW

--------------------------------------------------------------------------------

Therion 6.0.1 (2021-07-25):

therion:
 * flexible altitude bar height based on the number of colours in use
 * changed layout colour-legend option to <smooth/discrete/off/on>
 * bugs fixed:
   - wrong shading patterns references when exporting multiple maps
   - projection name truncated to 20 characters in Proj ver. > 5

--------------------------------------------------------------------------------

Therion 6.0.0 (2021-07-13):

therion:
 * support for colour models: cmyk, rgb, grayscale (see the color-model layout
   option in the Thbook)
 * support for colour management (see the color-profile layout option)
 * support for linear and radial shading (colour gradients) in MetaPost
   (withlinearshading and withradialshading options)
 * support for smooth colour transitions of scrap backgrounds in PDF maps
   if the map-fg is coloured by altitude
 * added smooth-shading <off/quick> layout switch – quick is the default
 * reimplemented internal processing of patterns and transparent colors in
   MetaPost (incompatible changes: the drawing option 'withtransparentcolor',
   macro 'def_transparent_rgb' and predefined transparent colors tr_bg,
   tr_white, tr_black were removed; use the drawing option
   'withcolor <color> withalpha <number>' instead)
 * reimplemented conversion of MetaPost output to PDF
 * support for double number system in MetaPost (this eliminates the current
   MetaPost limits; see the chapter Limitations in the Appendix of the Thbook)
 * tex-refs-registers <on/off> initialization file option added (see the
   chapters Initialization files and Limitations in the Appendix of the Thbook)
 * support for LuaTeX as an alternative to pdfTeX
 * support for relative paths in TeX (\inputrel, \savepath and \loadpicture) and
   in MetaPost (inputrel)
 * updated Serbian translation
 * bugs fixed:
   - symbol-hide,show,color not working for user defined symbols
   - ISO8859-2 literals in the source code caused clang warnings
   - removed unnecessary SOURCE_DATE_EPOCH in the thbook Makefile
   - fixed numerical instability in l_overhang_SKBB
   - swapped anastomosis & karren symbols
   - no station scrap continuation list [#333]
   - fixed arrows flipping [#245]
   - colour preview-above doesn't work [#90]
   - KML export fix [#84]
   - p_smartlabel fails with a picture argument
   - other minor fixes
 * included {fmt} library
 * updated shapelib
 
loch:
 * Tools→Selection – only displays selected surveys
 * bugs fixed:
   - missing title
   - autorotation issues

infrastructure:
 * support for CMake builds (thanks to Matěj Plch)
 * C++14 required
 * use Github Actions to create Github releases

--------------------------------------------------------------------------------

Therion 5.5.7 (2021-02-06):

therion:
 * added --generate-output-crc, --verify-output-crc options
 * error raised when unknown command line option used
 * version number ends with '-dev' if there are uncommitted local changes
 * optimizations:
   - much faster processing of fixed stations with associated CRS data
   - faster check for optional fonts
 * bugs fixed:
   - survey selection ignored when exporting 3d model from splay shots
   - "cs local" bugfix
   - scrap 3d reconstruction spike artifact fix
   - selection logging bugfix
   - svg/xhtml map export without filename creates cave.pdf file

make:
 * better detection of wx-config variants
 * innosetup.ini is generated in the build directory

--------------------------------------------------------------------------------

Therion 5.5.6 (2020-12-27):

therion:
 * fixed map statistics bug introduced in 5.5.5

--------------------------------------------------------------------------------

Therion 5.5.5 (2020-12-22):

therion:
 * updated Italian translation [#308]
 * fixed bug with statistic explo/topo/carto/copyright <number>
 * fixed bugs related to an undefined Area of Use, which should be used
   in Proj transformations

--------------------------------------------------------------------------------

Therion 5.5.4 (2020-12-15):

therion:
 * added layout-statistics carto|copyright-count
 * use unique pointers in thdatabase [#296]
 * added support for 270 to 360 degrees gradient readings
 * bugs fixed
   - scrap -walls off not working [#297]
   - various fixes [#293,294,295,296,298,299,301,302,303,305]

thbook:
 * support smaller page formats (configuration at the line 5 of the file
   thbook/thbook.tex)

loch:
  * bugs fixed:
    - fix display of Survex 3D with LRUD [#286]
    - read splay flag from Survex 3D files [#287]

make:
 * allow -j$N [#283]
 * allow passing of WX_CONFIG variable [#284]
 * remove local copies of getline and getopt [#290,306]
 * small fixes

infrastructure
 * use Github actions instead of Travis CI

--------------------------------------------------------------------------------

Therion 5.5.3 (2020-10-17):

therion:
 * mil/mils angle unit deprecation warning [#129]
 * sql export shot length precision increase [#147]
 * bugs fixed
   - incorect calculation of station position when fixed multiple times
     [#269,270]
   - memory leaks causing some random behaviour [#278]
   - scale value should default to 1 when omitted from "calibrate" [#263]

loch:
 * splay shots are rendered with darker colour
 * duplicate shots displayed by default
 * small bug fixes

--------------------------------------------------------------------------------

Therion 5.5.2 (2020-10-09):

therion:
 * added extend ignore path -- extend ignore <station1> <station2> <station3>
 * added ratio of extended elevation -- extend <0..100>
 * support CMYK colors in MetaPost symbols (this is not yet a complete
   CMYK support)
 * updated WKT definitions for some built-in projections
 * the names of projections defined by EPSG/ESRI are loaded dynamically
   from the Proj database if Proj version >= 6
 * undated surveys are listed in the Therion messages
 * documentation updates
 * updated German translation [#258]
 * bugs fixed
   - use proper ISO code for Czech language ('cs' instead of 'cz') [#251];
     'cz' is still allowed in the map layout for backwards compatibility
   - pdftex included in the windows installer failed to find images with
     '/./' or '/../' in the file path
   - splay shots extended elevation processing
   - another fix for Proj 7.1.0 axes swap in Krovak's projection
   - refuse to compile with unsupported Proj versions
   - depth is incorrectly taken from surface legs
   - Survex err reading bugfix
   - VTK9 compatibility fixes
   - Xtherion map georeferencing bugfix
   - mingw-w64 compatibility fixes
   - wxWidgets compilation issues
   - declination set to 0 outside of the geomag model range
     (now the declination is extrapolated 15 years after the model date;
     error is produced after that and before 1900)
   - other minor fixes

infrastructure:
 * add more Travis CI targets, update the libraries used
 * removed Therion library rebuilding

--------------------------------------------------------------------------------

Therion 5.5.1 (2020-07-03):

therion:
 * duplicate shot length removed from expored individual team member statistics
 * improved Proj support in auto mode (automatic specification of the area of use;
   caching and logging of the used transformations)
 * added support for handling of missing coordinate transformation grids
   (see the proj-missing-grid init file option)
 * support for linking with multiple Proj versions to improve testing
   (see test_proj.sh)
 * improved mingw-w64 compatibility
 * bugs fixed
   - various memory-related fixes by Matěj Plch [#242,243,244,248]
   - broken debug build [#246]
   - workaround for Proj 7.1.0 axes swap in Krovak's projection
   - various items missing from the clean targets [#252]

windows installer:
 * updated InnoSetup
 * updated TeX and MetaPost distribution
 * installer now includes the right version of Proj support files automatically

--------------------------------------------------------------------------------

Therion 5.5.0 (2020-05-01):

therion:
 * maps-offset <on|off> feature in thconfig file to disable maps drawn
   in offset [#159]
 * maps <on|off> feature in thconfig file to produce map just from scraps,
   ignoring the maps definition
 * log extend feature in thconfig to log extended elevation construction
 * added point mudcrack (thanks to Rodrigo Severo)
 * added an extensive SBE symbol set (thanks to Rodrigo Severo)
 * geomag data updated up to 2025
 * added support for reproducible generation of PDF and SVG output
   (command-line option --reproducible-output)
 * make thbook.pdf build reproducible (derive the created/modified dates
   of the PDF file from the commit date)
 * improved support for Proj 6.0 and 7.0 (see proj-auto init file option)
 * Catch2 unit testing library and Proj test cases added
 * all python scripts use Python 3 now
 * added Serbian (thanks to Ivana Miskovic) and Slovenian [PR#142] translations
 * updated Portuguese translation [PR#170,220]
 * thbook improvements by Benedikt Hallinger [PR#161,162]
 * bugs fixed
   - spelling in some thbook chapters
   - html and kml output [PR#145,150]
   - extend ingore <station> fixed
   - Survex 3D output is missing the nodes on the end of anonymous
     splay legs [#157]
   - a_blocks_AUT missing semi-colon [#126]

xtherion:
 * add thconfig* to selectable config file list [PR#168]
 * bugs fixed:
   - Windows xtherion window geometry bugfix

loch:
 * bugs fixed:
   - MacOS X compilation [PR#144]
   - multiple minor fixes
   - Linux off-screen rendering bugfix

--------------------------------------------------------------------------------

Therion 5.4.4 (2019-05-01):

therion:
 * support for Proj 5.0 and newer API (proj.h)
 * bugs fixed:
   - segfault while generating SVG when compiled by newer g++
   - incorrect EPSG projections handling if more than one EPSG codes are used
   - custom projection name missing
   - missing Proj4 human readable projection names

--------------------------------------------------------------------------------

Therion 5.4.3 (2019-02-01):

therion:
 * input line length increased to allow reading larger elevation datasets
 * built-in Proj.4 removed; internal mapping of EPSG and ESRI codes replaced
   by +init=epsg|esri:... libproj initialization string
 * bugs fixed:
   - add and use PROJ grid files in the windows distribution
   - fix comment and code typos [PR#127]

--------------------------------------------------------------------------------

Therion 5.4.2 (2019-01-08):

therion:
 * added -color option to select command
 * added lookup command to configuration
 * support for 3D models generated from splay shots
 * added support for label customization
 * added scrap distortions to SQL export
 * therion uses system libproj by default [PR#118,121]
 * metapost output is reproducible now [PR#117]
 * updated Spanish, German, Russian, Bulgarian, Portuguese, Catalan, French,
   Czech and English translations and messages
   [PR#77,78,82,83,94,95,102,103,105,107,108,109,112]
 * thbook updates [PR#76,98]
 * bugs fixed:
   - KML with multiple outer polygon outlines
   - other minor bugfixes

xtherion:
 * support for scrap shifting
 * bugs fixed:
   - fix problems with selection/copy/paste for text editors [PR#86]
   - mouse zooming fixed
   - disappearing menu fixed

loch:
 * bugs fixed:
   - displaying LRUD envelope for surface & splay shots
   - surface transparency rendering

--------------------------------------------------------------------------------

Therion 5.4.1 (2017-04-18):

therion:
 * added fonts-setup layout option
 * added min-symbol-scale layout option
 * added support for -scale <number> for point and line symbols
   (1.0 ≡ medium symbol size)
 * updated Russian translation [PR#73,74]
 * bugs fixed:
   - remove debugging output when reading Survex err files
   - don't accept stddev <= 0

--------------------------------------------------------------------------------

Therion 5.4.0 (2017-04-03):

infrastructure:
 * github.com/therion repos created
 * added support for mxe.cc cross-compiler
 * travis-ci.org integration

therion:
 * include UISv1 grade definitions [PR#6]
 * new ini file option: tex-fonts-optional
 * simple CSV database export with shot and equate lists [PR#9,19]
 * KML export improved (survey title, map comment, folder icons, entrances,
   survey names...) [PR#13]
 * added loop error info to .3d model
 * sync up img.c and img.h with latest Survex versions [PR#16]
 * update to latest poly2tri code [PR#43]
 * documentation improvements [PR#29,38,42]
 * Chinese translation added -- manual setup of fonts in the ini file
   (pdf-fonts) is necessary (thanks to Zhang Yuan Hai and Duncan Collis)
 * updated Bulgarian, Czech, English, German, Portuguese, Russian and Slovak
   translations [PR#9,12,18,34,41,46,55,56,58,60,65,67,68,69,70,72]
 * new and updated map symbols:
   - added line rope symbol, updated line handrail in MP [PR#9]
   - added area flowstone to AUT symbolset [PR#35]
   - added line fixed-ladder
   - added polyline_offset macro in MP
   - fixed AUT ceiling-step and ceiling-meander [PR#47]
   - changed AUT painted/fixed station to ASF:fixed layout [PR#48]
 * bugs and issues fixed:
   - fix missing font declarations when using pdf-fonts with more than 256 chars
   - added export of CLIP attribute in SHP export
   - include coordinate system and date-surveyed in the .3d export [PR#9,19]
   - fix warning "Can't Open Cavern Log File For Input" [PR#9]
   - fix compiler warnings [PR#10,22,24]
   - fix altitude colours with centreline [PR#11]
   - fix survex path detection
   - ensure text files end with a new line [PR#14]
   - fix typos in messages and comments [PR#17,23,25,39,40,45]
   - make "make clean" work fully for debug build [PR#20]
   - regularise indentation to use spaces [PR#26]
   - whitespace clean-up [PR#27]
   - sync divergent docs of therion command line [PR#28]
   - eliminate second copy of Survex img code [PR#33]
   - remove accidentally committed files [PR#37]
   - remove redundant NULL checks [PR#44]
   - use $(MAKE) instead of make [PR#51]
   - improve calculation of fractional year [PR#52]
   - fixing raft-cone point being drawn as raft [PR#54]

xtherion:
 * shortcuts to delete a line point (Ctrl-Shift-D) and zoom (Ctrl-Up/Down)
 * colouring of lines based on type
 * station point shown with triangle instead of dot
 * Line simplification command to reduce number of points without converting 
   to Bezier [PR#8]
 * apply proper collation when sorting [PR#71]
 * bugs fixed:
   - fix long delay processing large log files [PR#2]
   - fix loading of files with no extension in text editor [PR#30]
   - fix line point contextual menu [PR#61]
   - fix xtherion/lang/process.pl regex [PR#62]
   - include missing translatable texts [PR#63,66]
   - enable canvas zoom with the mouse wheel [PR#64]
   - incomprehensible error message while loading unsupported progressive JPEGs

loch:
 * manual page added [PR#15]
 * bugs fixed:
   - fix assertions with wxWidgets 3.0 [PR#1]
   - remove redundant NULL checks [PR#44]
   - fix loch "make depend" [PR#32]

--------------------------------------------------------------------------------

Therion 5.3.16 (2014-12-28):

therion:
 * scale upper limit changed to 1:10
 * geomag data updated up to 2020
 * bugs fixed:
   - black area displayed instead of some patterns in SVG
   - broken XHTML output when string formatting keywords are used in map-comment etc.
   - unescaped special characters in map-comment etc. in XHTML
   - improved error message when therion can't map custom TeX fonts in
     MetaPost macros to Unicode
   - cave depth value in XHTML output
   - invalid compass/backcompass averaging formula
      
xtherion:
 * elevation orientation in Compiler map structure
      
loch:
 * VTK 6.0 support
 * wxWidgets 3.0 support

      
--------------------------------------------------------------------------------

Therion 5.3.15 (2014-05-27):

therion:
 * multiline comments inside (comment/endcomment) block allowed in
   data and configuration files
 * new TeX variables
   \cave[max|min]z = altitude max|min value
   \thversion = current therion version
   \currentdate = current date
   \outcs[code|name] = output CS code and name
   \northdir = true or grid
   \magdecl = magnetic declination in degrees
   \gridconv = grid meridian convergence in degrees
 * new metapost variables
   NorthDir = "true" or "grid"
   MagDecl = magnetic declination in degrees
   GridConv = grid meridian convergence in degrees
 * bugs fixed:
   - invalid colors for station names and wall altitudes
      
xtherion:
 * resetting symbol options when type is changed can be turned off using
   xth(gui,me,type_reset_options) variable
 * you can turn off symbol type translation in dropdown menus using 
   xth(gui,me,type_dropdown_trans) variable
 * bugs fixed:
   - area type u type change bug
      
--------------------------------------------------------------------------------
Therion 5.3.14 (2014-02-22):

xtherion:
 * added Undo/Redo toolbar buttons
 * added option Edit->Hide inactive scraps
 * added context menu, right click on line and point
      
--------------------------------------------------------------------------------
Therion 5.3.13 (2014-01-22):

therion:
 * bugs fixed:
   - update survex img parser to v8 (should fix various errors)
   - several patches from Wookey's debian distribution applied

--------------------------------------------------------------------------------
Therion 5.3.12 (2013-12-22):

therion:
 * -enable/disable spay-shots should work for VRML and DXF format (splay
   shots in separate layer)
 * added ATTR__shotflag_splay, ATTR__shotflag_duplicate, ATTR__shotflag_approx
   to metapost code before line survey
 * warning raised, if equate statement creates new station in some subsurvey
 * removed transaction from SQL export
 * bugs fixed:
   - color map-fg altitude should work for elevation projection
   - error deleting temporary directory
   - missing vcomp100.dll in Win32 installation
      
xtherion:
 * bugs fixed:
   - BOM handling in UTF-8 files
   - ver.tcl ends with lf only
      
loch:
 * bugs fixed:
   - file open dialog not working properly on Debian linux

--------------------------------------------------------------------------------
Therion 5.3.11 (2012-12-22):

therion:
 * added -survey option for map for setting survey associated with map.
   For example all surveying statistics from this survey will be used, when
   this map is selected for output.
 * added sketch-colors <number-of-colors> option to thconfig file,
   to reduce size of sketch bitmap images in maps
 * hide symbol from legend, if it has explicitly empty translation
 * survey-level works for point station-name labels, if station name is
   automatically determined (no -text is specified) 
 * symbol-show|hide group text for point label, remark, date and line label
 * grid-angle <value> <units> - can be used in centerline to specify magnetic
   grid angle (declination against grid north).
 * -cs output specification works for export cave-list (including lat-long)
 * dates are shown using OS locale settings in map export
 * layout statistics explo/topo-length on/hide/off -- if it is off, 
   team members are sorted alphabetically
 * KML export format supported for cave-list and continuation-list
 * bugs fixed:
   - PLT export in output coordinate system
   - context point air-draught not working
   - instrument position in centerline does not work
   - debug scrap-names crashes if empty scraps
   - counter not working in centerline data diving
   - revise not working outside of survey context
   - wrong length/depth and other statistics calculation for map output
   - sketch bitmaps inserted multiple times in PDF files
   
xtherion:
 * bugs fixed:
   - new file in xtherion works, even if file is already open

--------------------------------------------------------------------------------
Therion 5.3.10 (2012-08-13):

therion:
 * added new point types: ice-stalactite, ice-stalagmite, ice-pillar, 
   clay-choke, clay-tree
 * added new wall subtypes: pit, flowstone, moonmilk, overlying
 * added new symbol groups: ice, sediments
 * added -height option for pit/wall:pit
 * added new layout option: color map-bg transparent
 * full OSGB grid coverage (e.g. cs OSGB:ST)
 * Austrian symbol set added (thanks to Georg Pacher)
 * added New Zealand symbol set (NZSS, thanks to Bruce Mutton)
 * updated UIS symbol set (thanks to Bruce Mutton)
 * updated German translation (thanks to Georg Pacher)
 * updated Italian translation (thanks to Marco Corvi)
 * added bulgarian translation (thanks to Alexander Yanev)
 * updated English translation (thanks to Bruce Mutton)
 * added te reo Maori translation (thanks to Kyle Davis)
 * added possibility to define own coordinate system in therion.ini (cs-def)
 * updated survex img library to version 1.1.15
 * added option -enable/disable splay-shots to 3d model export
   (works with .3d and .kml file formats) 
 * bugs fixed:
   - fixed huge coordinate numbers in extended elevation xvi
   - xvi with sketches export
   - unnecessary warningcheck changes eliminated from metapost code
   - fixed bug with 3d model generation from scraps without outline
   - fixed bug with missing patterns in symbols.xhtml
   - fixed bug - direction point not working with line secion
   - fixed inaccurate clipping of coloured scrap background
   - fixed placement of surface bitmaps with larger offset
   - fixed alignment of some point symbols in AUT symbol set
   - missing white fill below cave passages in transparent PDFs if background
     colour is white (needed if the map is included into other map with 
     non-white background)
   - fixed incorrect line width conversion in some patterns
   - hide white background of scraps when the PDF layer containing them
     is invisible
   - constrained Delaunay triangulation engine replaced by poly2tri
   - passage outline scanning algorithm improved
   - "nosurvey" shots allowed between unfixed stations
   - added missing area flowstone, moonmilk and bedrock into legend
   - fixed xvi export of extended elevation
   - fixed symbol-hide/show point remark bug
   - fixed wall:debris bug in AUT symbol set (thanks to Georg Pacher)
   - fixed layout color map-bg transparent bug
   - LRUD area dimensions is drawn for all shots before these shots are drawn
     (centerline is compact when map is exported from centerline only)
   
xtherion:
 * bugs fixed:
   - 
   
loch:
 * VTK file export changed to binary type (problem with coordinate systems)
 * added checkbox that enables/disables surface lighting (Scene->Surface)
 * bugs fixed:
   - vthreshold should work now for LRUD modelling

--------------------------------------------------------------------------------
Therion 5.3 (2010-02-17):

therion:
 * added <lang:XX> language selector for strings
 * -filter (on)|off option added to continuation export to support export
   of all continuations
 * -surveys (on)|off option added to cave-list export to allow export of raw
   list of caves
 * new easy setup for OpenType and TrueType fonts (requires lcdf-typetools)
   (new otf2pfb and pdf-fonts options in therion.ini)
 * basic support for right-to-left scripts in labels and legend
 * PDF files now contain unicode mapping information to allow searching and 
   copying texts consisting of accented and non-latin characters
 * georeferencing data added to pdf maps
 * new layout option: symbol-color <type> <symbol> <color>
 * new symbol groups: water, speleothems, passage-fills, equipment
 * new flags for stations: arch and overhang to mark these surface 
   karst features
 * support for splay shots without station names (using "-" or "." as station 
   name)
 * added greek translation (thanks to Stelios Zacharias)
 * added albanian translation (thanks to Fatos Katallozi)
 * updated german translation (thanks to Roger Schuster; Georg Pacher's 
   additions to be implemented soon)
 * sketches displayed in map layer in pdf and svg, not among surface bitmaps (T#8996)
 * PROJ.4 library updated to 4.7.0
 * geomag data updated until 2015
 * bugs fixed:
   - BCRA3 and BCRA5 survey grades fixed
   - missing altitudes in cave list
   - atlas page exclusion
   - map header positioning using real numbers
   - attribute export to metapost
   - fixed russian translation (B#26399)
   - transparency in metapost reset when followed by clipped area
   - back readings supported in data roles+instruments
   - missing LRUD data in PLT export (B#25532)
   - segfault on line with single point
   - "-flip none" not working for scrap
   - lat/long out of range
   - map-header x y off behaves as if map-header x y nw (B#25537)
   - incorrect boundary of background sketches in pdf and svg maps
   
xtherion:

 * script for creation of OziExplorer MAP files for georeferenced maps 
   (Help->Calibrate bitmap)
 * added import functions for PocketTopo export
   - centerline in text editor: File->Import->PocketTopo therion export
   - sketches in map editor: Background Images->Insert->PocketTopo therion export
 * bugs fixed:
   - increasing of station numbers with leading zeros or trailing letters
   
loch:

 * added File->Import function to allow merging of e.g. 3d files with DTM in 
   loch format
 * added Tools->Options->Measurement system setup
 * splay and duplicate shots are hidden by default
 * entrances, stations and fixed stations and their labels can be displayed
   on screen (added toolbar buttons and Scene setup->Stations control panel)

--------------------------------------------------------------------------------
Therion 5.2 (2008-08-07):

therion:
 * statistics of explored but not yet surveyed passages. Just specify 
   `-explored <length>' to point continuation or add `explored <length>' to
   station flags and this length will be used in survey/cave statistics.
 * new handling of user defined symbols (including legend)
 * improved station flags handling. Added new flags for stations: sink, spring,
   doline, dig, air-draught(:winter|summer). Also `not' is supported before flag.
   User defined attributes may be added to stations using flag `attr' followed
   by attribute name and value.
 * station flags can be turned on|off using layout:
   symbol-show|hide point flag:entrance|continuation|sink|spring|doline|dig...
 * added `splay' and  `approx[imate]' survey shot flag
 * grid labeling using coordinates - layout option grid-coords off|border|all
 * ability to color labels by scrap color using `color labels on|off' in layout
 * user can change translation of therion texts at runtime using `text'
   option in configuration or initialization files
 * when layouts are copied one into another, map-comments are concatenated
   instead of replaced
 * added russian translations + encodings (thanks to Vasily Vl. Suhachev)
 * updated french translations (thanks to Gilbert Fernandes)
 * attributes to metapost are exported as strings only
 * bugs fixed:
   - symbol-show|hide line moonmilk works
   - declination output fixed (half year shift removed)
   - invalid LRUD dimensions in PDF map output
   - installation script
   - page grid origin not affected by rotation/meridian convergence
   - scale works with all point labels
   
xtherion:

 * ERROR/WARNING state of compilation
 * changed increased default sidebar width + default sidebar width
   configuration option in xtherion.ini file
 * single .xtherion.dat file containing survey and map structures is created
   after compilation
 * bugs fixed: 
   - "end of line" characters translation
   - toolbar icon decriptions added to localization files
   
loch:

 * export of cave 3D model in VTK format using File->Export
 * bugs fixed: 
   - wxWidgets 2.8.0 compilation thanks to Olly Betts
   - walls altitude coloring under Linux

--------------------------------------------------------------------------------
Therion 0.5.1 (2007-08-29):

therion:

 * added configuration for debian based linux systems: make config-debian
 * new samples directory
 * new subtypes for air-draught symbol: winter and summer
 * new area types: flowstone, moonmilk
 * ability to display overlying maps in offset
 * new point and line type: map-connection (used to indicate
   connection between map parts - extended elevations, maps in
   offset)
 * improved default centerline symbols
 * LRUD envelopes of maps exported from centerline
 * point -extend option changed to -from
 * user defined types of points/lines/areas (using u type and 
   custom subtype string e.g. u:electric-cable)
 * scraps without calibration stations are allowed
 * coordinate system specification allowed for scraps
 * areas exported to SHP files
 * export of simple DXF maps
 * updated Italian translation (thanks to Marco Corvi)
 * bugs fixed:
   - top level objects selection
   - generation of extended elevation
   - map coloring
   - creating surveys from .3d files
   - subpixel inaccuracy with bitmap morphing
   - entering angles/lat-long in degree:minutes format
   - shapefile export fixes
   

xtherion:

 * DXF/SVG import in map editor (File->Import)
 * symbol themes and translations comboboxes
 * autocompletion in symbol type comboboxes
 * bugs fixed:
   - translations of type:subtype works

loch:

 * first Mac OS X version works
 * bugs fixed: 
   - surface texture mapping under Linux

--------------------------------------------------------------------------------
Therion 0.5.0 (2007-02-02):

therion:

 * geodetic coordinate systems support -- CS specification in
   layout, centerline, surface, import and configuration file.
   Coordinate systems used all around the world are supported
   (EPSG and ESRI standards).
 * added GEOMAG model for automatic calculation of magnetic
   declination according to cave coordinates and survey date
 * multiple images (PDF, PNG, JPEG) in PDF map supported
   (e.g. plan and xelevation in single PDF) using new layout
   option map-image <x> <y> <align> <filename>
 * new improved vector morphing algorithm
 * morphing of survey sketches now supported. New -sketch option 
   for scrap + sketches switch in layout. Allows export of morphed 
   survey sketches in PDF and XVI. ImageMagick package 
   (convert and identify executables) are needed to use these features.
 * -attr option for specification of user defined attributes,
   valid for all objects. Attributes are exported to metapost
   code using ATTR_* variables.
 * shapefile map export format
 * Google Earth (.kml) map (scrap outlines) and model (centerline)
   export
 * -enc|-encoding option allowed for map and model export
 * top level survey command not needed any more
 * survey: new -namespace switch, enables using datasets with
   unique station names
 * new area type: bedrock
 * subtype specification is now possible using ":" separator 
   (e.g. border:invisible)
 * added "system" command in configuration files to execute
   system commands during therion compilation 
 * new layout option: north (true)|grid
 * -calibrate option for import
 * source/endsource construct allowed in configuration files
 * input allowed within multiline commands
 * improved ceiling and floor meander symbols
 * background centerline map exported only when no scraps or maps
   exist
 * support for 1.1 survex .3d file format
 * added German translation of symbols (thanks to Roger Schuster),
   updated Italian translation (thanks to Marco Corvi).
 * default Linux installation is done into "/usr/local" instead 
   of "/usr" directory
 * bugs fixed:
   - automatic calculation of atlas paper size when only size is specified
   - extended elevation generation ("break" removed, only "ignore"
     works)
   - empty map when exported with -layout-color map-fg map

xtherion:

 * compiler preview toolbox (experimental, acrobat reader supported
   on Win32, xpdf on Linux (original idea of Marco Corvi))
 * sketch control (insert, remove) in scrap toolbox
 * 3D viewer removed from xtherion
 * does not connect to Internet any more to check new version available
 * remembers last working directory on Windows
 * improved scrap scaling - "Scale" button + scale preview arrow in scrap
   control
 * scrap selection selects current scrap first
 * bugs fixed:
   - hang when area inserted at the end of file
   - deleting contents of configuration files should not happen any more
   - fixed zooming of transparent pictures

loch:

 * bugs fixed: 
   - initial size on multiple display machines
   - crash when file with texture is opened as loch argument (or
     doubleclick on Win)

--------------------------------------------------------------------------------
Therion 0.4.0 (2006-10-02):

therion:

 * loch - new 3D viewer and default 3D export format
 * VRML model export improved (added surface texture)
 * export model: -wall-source (all)|maps|centerline -- specify
   the source of passage walls
 * layout: survey-level <N> -- show up to N surveys with station
   names (default N=0, survey-level all is also accepted).
 * 3d file import improved -- multiple imports of the same centerline
   allowed
 * if no map is selected with export, also centerline is exported
 * symbol sets overview using --print-symbols option. Output in 
   XHTML format (file symbols.xhtml).
 * fixed bug with autojoin and multiple projection output

xtherion:

 * images outside .th2 file path accepted, relative path is still
   created using ".." directory reference
 * area border lines are highlighted, when selected in listbox
 * backup of configuration files is created after OK compilation
 * added IT translation

--------------------------------------------------------------------------------
Therion 0.3.10 (2006-04-05):

therion:

 * decimal point in low passage heights
 * fixed bugs: loop closure errors log, symbol-hide group cave-centreline
 * SVG export in XHTML format
 * flowstone and waterflow symbols joined in legend, if used
   as line and point together
 * improved loop closure method selection - if there was an error
   when processed using survex - therion is used for loop closure
 * when scrap size exceed metapost limits - more reasonable errors
   are generated + limit for centerline scraps is larger
 * layout: you can change overlap or size and page setup is automatically 
   recalculated
 * layout: color map-fg scrap
 * layout: debug station-names

xtherion:

 * added toolbar (thanks to dzach)
 * added text editor template (in xtherion.ini file)

--------------------------------------------------------------------------------
Therion 0.3.9 (2005-08-30):

therion:

 * units (metric)|imperial in layout and initialization file
 * new therion.ini switch: loop-closure therion|survex
   By default, survex is used if present, otherwise therion.
 * fixed bugs - error log when disk full, vtreshold -> vthreshold
 * map export to .3d files
 * scraps in one .th2 file that have common end line points are
   automatically joined
 * scrap names in map output, via layout: debug scrap-names

xtherion:

 * fixed bugs - view is not moved when line is split, file is
   not changed when image insertion is canceled

--------------------------------------------------------------------------------
Therion 0.3.8 (2005-05-10):

therion:

 * SVG export added (features not yet supported: map header, font embedding,
   layers, map transparency -- this requires SVG 1.2 features)
 * DXF model export added
 * export format automatically determined from file extension
 * layout: map-header-bg on|(off) - when on, background of map 
   header is filled with background color
 * .ini files installed into /etc directory, .ini.new files always installed

xtherion:

 * new items in xtherion.ini file
 * text editor - indent mode now similar to ordinary text editors

--------------------------------------------------------------------------------
Therion 0.3.7 (2005-03-16):

therion:

 * new (more intuitive) extended elevation arrangement
 * new import options: filter, surveys
 * new surface option: grid-flip
 * new centerline option: extend
 * new point type: dimensions
 * new scrap option: flip 
 * new scrap/centerline option: station-names 
 * reduced `extend' point option
 * all altitudes are exported as a difference against grid Z origin
 * XVI (xtherion vector image) map export
 * UD data from centerline used in 3D model generated from scraps
 * plt export with LRUD data
 * `/' supported as survey name character
 * Unicode characters support in layout TeX code
 * fixed bugs: plumbed shots; join; statistics of centerline only maps

xtherion:

 * limited i18n support
 * XVI support (automatic insertion of survey stations, LRUD data)
 * fixed bug with gamma correction

--------------------------------------------------------------------------------
Therion 0.3.6 (2005-01-31):

therion:

 * LRUD passage dimensions support
 * centreline processed in other programs (*.3d, *.plt) may be imported
 * transparent solid surface in 3D model
 * map colouring support
 * map grid support
 * if station subtype is not specified, Therion reads it from centreline, 
   if it's specified there
 * MetaPost symbols completed and improved (error handling,
   division by zero fixed)
 * scrap filled and clipped correctly even if scrap border intersects itself
 * centerline, bounding box and surface supported in 3DMF and VRML export
 * Spanish translation added
 * input language changes:
   - centreline command: mark, walls, vtreshold;
     + new role pics
     + new data item ignoreall
     + new data type dimensions 
       (station, up/ceiling, down/floor, left, right)
     + LRUD dimensions may specified as pair [<from> <to>]
   - point command: snow
   - line command: ceiling/floor-meander, border:presumed
     + line gradient and water-flow not clipped by default
   - area command: blocks, snow, ice, clay, pebbles
   - scrap command: -3d changed to -walls option
   - equate command: may be used outside of centreline
   - import command added
 * configuration file changes:
   - layout command: grid, grid-size, code/endcode, color map-fg <altitude/map>,
       color-legend

xtherion:

 * new items in xtherion.ini
 * file timestamps are checked while saving
 * auto save feature
 * lot of bugfixes
 * Map editor: new shortcuts (ctrl-a, ctrl-r, page up/down, shift page up/down)
 * Map editor: clicking twice on the same point ends the point insertion mode
 * Map editor: station names are automatically increased (or decreased :) in
   extended elevation)

--------------------------------------------------------------------------------
Therion 0.3.5 (2004-11-25):

therion:

 * map rotation in 2D output supported
 * bug fixed: -scale option works for point labels
 * input language changes:
   - centreline command: percent[age] clino units support
 * configuration file changes:
   - layout command: rotate

xtherion:

 * Map editor: point, line and area symbol are never inserted 
   outside of a scrap
  
--------------------------------------------------------------------------------
Therion 0.3.4 (2004-10-22):

therion:

 * MetaPost and TeX supplied in Therion for Windows installer
   work even if there is other TeX(Live) installation present in the system
   (see the tex-env initialization file option)
 * if there are no maps defined and map is exported,
   all scraps in given projection are exported
 * input language changes:
   - centreline command: group/endgroup
 * initialization file: 
   - new option: tex-env
 * fixed bug in atlas export introduced in 0.3.3
 * fixed minor MetaPost bugs

xtherion:

 * Compiler: hyperlinked error messages
 * Map editor: larger tick at the line symbol beginning
 * Map editor: new scrap is inserted in the beginning of the file
 * Map editor: fixed bug when deleting last line point
 * Map editor: line symbol type change resets rotations and lengths
   set-up in the line points

--------------------------------------------------------------------------------
Therion 0.3.3 (2004-09-10):

therion:
  
 * surface (topographical) map supported in 2D maps
 * surface grid supported in 3D models (therion format)
 * typesetting of legend symbols in multiple columns fixed 
 * input language changes:
   - new command surface
   - point, line and area commands have new option: context
   - line command: survey has new subtypes: cave, surface
   - line command has new option: adjust
   - map command: ability to draw centreline from specified survey without
       drawing a scrap; 
       new option: projection
 * configuration file changes:
   - layout command has new options: legend-width, legend-columns, 
       surface, surface-opacity
   - export model has new options: enable, disable

xtherion:

 * Model viewer: mouse wheel supported

--------------------------------------------------------------------------------
Therion 0.3.2 (2004-07-22):

therion:

 * configuration file changes:
   - layout command: scale 1 50 up to 1 100000 allowed and supported
 * Therion constructs accented characters if the character is not present
   in the font. It used to omit the accent and display the base character only
 * error message `invalid command context' changed to 
   `missing xxx command before yyy command'
 * French translation added

xtherion: 

 * line split bug fixed
 * automatically checks for updates
 * 3D viewer: reload (Ctrl+R)
 * 3D viewer: bounding box computation fixed


--------------------------------------------------------------------------------
Therion 0.3.1 (2004-04-23):

therion:

 * input language changes:
   - scrap command has new option: 3d
 * windows version: accepts slashes as directory separators in the 
   export command
 * Czech translation added

xtherion: 

 * Map editor: fixed bug with empty lines displayed as text
 * Map editor: doesn't allow to insert a background image if the *.th2
   file hasn't been saved

--------------------------------------------------------------------------------
Therion 0.3.0 (2004-04-16):

therion:

 * Therion exports 3D model
 * loop closure algorithms implemented in Therion
 * input language changes:
   - centreline command: fix doesn't accept covariances specification
 * configuration file changes:
   - layout command: map-header improved
   - export command: new formats for 3D model export added -- vrml, 3dmf,
     therion (default)
 * initialization file changes: 
   - removed item: path-cavern
 * log file contains both loop errors and scrap distortions at the end
 * completely new Win32 installation with TeX and Tcl/Tk included

xtherion:

 * data file may be specified as an argument from the command line
 * basic 3D model viewer added
 * Map editor: only the visible part of background images is zoomed
   (less memory consumption and speed improvement)
 
--------------------------------------------------------------------------------
Therion 0.2.19 (2004-03-01):

therion:

 * input language changes:
   - place option of point, line, area commands: none renamed to default
   - area command: place bottom is default
   - line command: if contour has no gradient specified, visualization
      is symbol-set dependent (no gradient tick in UIS, tick in the middle
      in SKBB)
   - line command: pit may be spelled as pitch
   - line command has new type: gradient
   - survey command has new option: person-rename
 * configuration file changes:
   - layout command has new option: debug
   - select command: new rules for selection if there is no map selected
 * scrap transformation improved, distortion logged in the log file
 * debugging map mode shows scrap distortions
 * bug fixed in PLT export 

xtherion:

 * Map editor: status bar displays command preview
 * Map editor: new Area control
 * Map editor: `Move to' in File commands added
 * Map editor: name of the edited scrap displayed in Title bar
 * Map editor: edited line is highlighted
 * Map editor: selected area is highlighted
 * Map editor: orientation tick at the beginning of line symbols
 * Help/Control dialog with key and mouse shortcuts
 * input (keyboard) encoding menu

--------------------------------------------------------------------------------
Therion 0.2.18 (2004-02-12):

therion:

 * Therion supports translations of texts in PDF map/atlas output
 * Therion exports centreline to SQL database
 * input language changes:
   - line command has new type: water-flow
   - centerline command: discovery-date/team renamed to explo-date/team
   - layout command has new options: language, colo[u]r, symbol-show,
       map-comment, map-header, scale-bar, statistics
   - -author and -copyright options apply only to centreline and scrap,
     -title to survey, centreline, map and scrap
   - it's possible to leave date field unspecified `-'
 * configuration file changes:
   - export command has new type: database
 * initialization file changes: 
   - new items: language, encoding-sql
   - encoding_default renamed to encoding-default
 * air-draught ticks set according to -scale option

--------------------------------------------------------------------------------
Therion 0.2.17 (2003-12-04):

therion:

 * input language changes:
   - layout command has new options: base-scale, 
       symbol-set, symbol-assign, symbol-hide
   - size option for point and line symbols accepts following values: 
       tiny (xs), small (s), normal (m), large (l), huge (xl)
 * support for run-time loading of map symbols
 * MetaPost processing optimizations

--------------------------------------------------------------------------------
Therion 0.2.16 (2003-11-24):

therion:

 * input language changes:
   - centerline command has new team roles: instruments (insts), assistant (dog)
   - centerline command has new data readings: 
       up/ceiling, down/floor, left, right, ignore
   - centerline may be spelled as centreline
   - deg:min:sec syntax allowed for degree values
   - point, line and area commands have new option: visibility on/off
 * new rules for displaying map previews
 * new initialization file items: tmp-path, tmp-remove
 * error if no source files are specified
 * if error occurs under Win32, Therion waits until RETURN is pressed

xtherion:

 * Help/BAC Calculator dialog added

--------------------------------------------------------------------------------
Therion 0.2.15:

therion:

 * input language changes:
   - layout command has new option: code <metapost|tex-map|tex-atlas>
   - join command has new option: count <N>
 * therion checks validity of UTF-8 encoded input files
   
xtherion:

 * bug fixed -- compiler does not add empty lines to config files

--------------------------------------------------------------------------------
Therion 0.2.14 (2003-07-16):

therion:

 * input language changes:
   - layout command has new option: layers on/off
 * initialization file syntax changes: 
     cavern-path, pdftex-path, mpost-path, source-path
 * fonts setup for PDF output
 * updated documentation
 * Therion reads (definitely) following environment variable: 
   - THERION -- search paths for [x]therion.ini file

--------------------------------------------------------------------------------
Therion 0.2.13 (2003-06-16):

therion:

 * thpdf, theps2pdf and 3dtops external programs integrated into Therion
 * MetaPost and TeX macros compiled into Therion 
 * compilation: just "make" is enough; works also on win32 systems
 * input language changes:
   - centerline command has new options: discovery-date, discovery-team
   - point command: type anostomosen renamed to anastomosis
   - layout command has new option: transparency on/off
   - layout command has changed option: opacity 0.0-100.0
   - layout command has changed option: grid-size is measured in real units
 * Therion reads following environment variables: 
   - THINIT -- search paths for [x]therion.ini file
   - THERION -- search paths for configuration and source files
 * PDF output: support for Optional Content Groups (Layers) in Acrobat 6

xtherion:

 * Text editor: text undo/redo works with tcltk8.4.3
 * Map editor: line symbols may be split
